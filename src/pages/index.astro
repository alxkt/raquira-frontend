---
import Gallery from "../components/gallery/Gallery.astro";
import Lightbox from "../components/gallery/Lightbox.astro";
import { fetchCollectionBySlug } from "../lib/api";
import type { Photo } from "../lib/photos";
import "../styles/global.css";

const API_BASE_URL =
	import.meta.env.PUBLIC_USE_LOCAL_BACKEND === "true"
		? "http://localhost:8080"
		: import.meta.env.PUBLIC_API_BASE_URL;

let photos: Photo[] = [];
let error: string | null = null;
try {
	const collection = await fetchCollectionBySlug(API_BASE_URL, "featured");
	photos = collection.photos;
} catch (e: any) {
	error = e?.message || "Failed to load featured photos";
}
const baseURL = import.meta.env.PUBLIC_IMAGE_BASE_URL;
---

<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="viewport" content="width=device-width" />
		<meta name="generator" content={Astro.generator} />
		<title>Raquira</title>
		<!-- Google Fonts preconnect for performance -->
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

		<!-- Selected fonts: Poppins for headers, Inter for body -->
		<link
			href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap"
			rel="stylesheet"
		/>
		<link
			href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap"
			rel="stylesheet"
		/>
	</head>
	<body class="bg-zinc-950 p-8" style="font-family: 'Inter', sans-serif;">
		<h1
			class="text-red-50 text-8xl font-bold mb-8"
			style="font-family: 'Poppins', sans-serif;"
		>
			Raquira
		</h1>

		<div class="mb-8">
			<p class="text-gray-300 text-2xl mb-4">
				A curated collection of 1970s photography from Raquira,
				Colombia. Explore the townâ€™s history and culture through these
				images.
			</p>
		</div>

		{
			error ? (
				<p class="text-red-400 font-medium">{error}</p>
			) : (
				<>
					<Gallery photos={photos} baseURL={baseURL} />
					<Lightbox photos={photos} baseURL={baseURL} />
				</>
			)
		}

		<!-- Explore Button -->
		<div class="mt-16 mb-8 flex justify-center">
			<a
				href="/explore"
				class="group inline-flex items-center gap-3 px-8 py-4 bg-zinc-900 hover:bg-zinc-800 border border-zinc-700 hover:border-zinc-500 rounded-full text-zinc-200 hover:text-white text-lg font-medium transition-all duration-300 hover:scale-105 hover:shadow-lg hover:shadow-zinc-900/50"
				style="font-family: 'Poppins', sans-serif;"
			>
				<span>Explore the Collection</span>
				<svg
					class="w-5 h-5 transition-transform duration-300 group-hover:translate-x-1"
					fill="none"
					stroke="currentColor"
					viewBox="0 0 24 24"
				>
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						stroke-width="2"
						d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
				</svg>
			</a>
		</div>
	</body>
</html>
